# autoscaling-group-resize
Script for changing EC2 instance sizes after Turbo updates the launch config 

This script should be used in AWS for autoscaling groups which are resized by a Turbonomic instance version 6.3 or later. 

The script will runs in a lambda function based on on an event generated by a Turbo instance to change the launch config for an ASG
It first ensures the event is generated by the right Turbo instance
Second it increases the capacity of the ASG 
Third it sequentually terminates the older EC2 instances in the ASG allowing the ASG scaling process to ensure EC2 instance type consistency 
Note, this uses a 60 second  grace period for changing the ASG, you could turn on CloudWatch for the ASG and use those metrics insted (e.g. GroupInServiceInstances)

To set up this up in AWS do the following:
- Ensure to update the python script with the name of the Target you defined in Turbonomic for the AWS account you will be execuing the resize in (the current script has "PM.sedmo" as a place holder)
- Create the Lamnda function with the Python Script (testested with Python 3.6 runtime, 128 MB size and 15 minute time out) 
- Create a CloudWatch event rule with Service Name as 'Auto Scaling', Event Pattern as 'AWS API Call via CloudTrail' and Specific Operation as 'UpdateAutoScalingGroup'
- For the CloudWatch event rule configure the Target as the Lambda function you created 
